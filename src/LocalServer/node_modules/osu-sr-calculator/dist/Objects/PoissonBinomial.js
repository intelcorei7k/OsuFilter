"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const distributions = require('distributions');
class PoissonBinomial {
    constructor(probabilities) {
        this.mu = probabilities.reduce((total, current) => total + current);
        this.sigma = 0;
        let gamma = 0;
        probabilities.forEach(p => {
            this.sigma += (p * (1 - p));
            gamma += (p * (1 - p) * (1 - 2 * p));
        });
        this.sigma = Math.sqrt(this.sigma);
        this.v = gamma / (6 * Math.pow(this.sigma, 3));
    }
    Cdf(count) {
        const k = (count + 0.5 - this.mu) / this.sigma;
        const normal = distributions.Normal(0, 1);
        const result = normal.cdf(k) + this.v * (1 - k * k) * normal.pdf(k);
        if (result < 0)
            return 0;
        if (result > 1)
            return 1;
        return result;
    }
}
exports.PoissonBinomial = PoissonBinomial;
